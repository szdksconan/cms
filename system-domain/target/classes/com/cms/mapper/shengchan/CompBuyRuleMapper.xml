<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cms.mapper.shengchan.CompBuyRuleMapper">
	<resultMap id="BaseResultMap" type="com.cms.model.shengchang.CompBuyRule">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="ID" property="id" jdbcType="BIGINT" />
		<result column="compId" property="compid" jdbcType="BIGINT" />
		<result column="rule_name" property="ruleName" jdbcType="VARCHAR" />
		<result column="rule_time" property="ruleTime" jdbcType="VARCHAR" />
		<result column="creator" property="creator" jdbcType="VARCHAR" />
		<result column="apply_type" property="applyType" jdbcType="VARCHAR" />
		<result column="pay_way" property="payWay" jdbcType="VARCHAR" />
		<result column="rule_desc" property="ruleDesc" jdbcType="VARCHAR" />
		<result column="jiesuan_type" property="jiesuanType" jdbcType="VARCHAR" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		ID, compId, rule_name, rule_time, creator, apply_type, pay_way,
		rule_desc,jiesuan_type
	</sql>
	<sql id="querySql">
		<where>
			<if test="ruleName != null and ruleName!=''">
				rule_name like  concat('%',#{ruleName},'%')
			</if>
			<if test="applyType != null and applyType!=''">
				and apply_type like  concat('%',#{applyType},'%')
			</if>
			<if test="compid != null and compid!=''">
				and compId=#{compid}
			</if>
		</where>
	</sql>
	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from comp_buy_rule
		where ID = #{id,jdbcType=BIGINT}
	</select>
	<select id="getBuyRuleByCompId" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from comp_buy_rule
		where compId = #{compid,jdbcType=BIGINT}
	</select>
	<select id="getAllBuyRule" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from comp_buy_rule
	</select>
	<select id="pageBuyRule" resultMap="BaseResultMap"
		parameterType="com.alibaba.fastjson.JSONObject">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from comp_buy_rule 
		<include refid="querySql" />
		${orderString}
	</select>
	<select id="getTotalBuyRule" resultType="int"
		parameterType="com.alibaba.fastjson.JSONObject">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
			count(*)
		from comp_buy_rule
		<include refid="querySql"/>
	</select>
	
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from comp_buy_rule
		where ID = #{id,jdbcType=BIGINT}
	</delete>
	<insert id="insert" parameterType="com.cms.model.shengchang.CompBuyRule">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into comp_buy_rule (ID, compId, rule_name,
		rule_time, creator, apply_type,
		pay_way, rule_desc,jiesuan_type)
		values (#{id,jdbcType=BIGINT}, #{compid,jdbcType=BIGINT},
		#{ruleName,jdbcType=VARCHAR},
		#{ruleTime,jdbcType=VARCHAR}, #{creator,jdbcType=VARCHAR}, #{applyType,jdbcType=VARCHAR},
		#{payWay,jdbcType=VARCHAR},
		#{ruleDesc,jdbcType=VARCHAR},#{jiesuanType,jdbcType=VARCHAR})
	</insert>
	<insert id="insertSelective" parameterType="com.cms.model.shengchang.CompBuyRule">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into comp_buy_rule
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				ID,
			</if>
			<if test="compid != null">
				compId,
			</if>
			<if test="ruleName != null">
				rule_name,
			</if>
			<if test="ruleTime != null">
				rule_time,
			</if>
			<if test="creator != null">
				creator,
			</if>
			<if test="applyType != null">
				apply_type,
			</if>
			<if test="payWay != null">
				pay_way,
			</if>
			<if test="ruleDesc != null">
				rule_desc,
			</if>
			<if test="jiesuanType != null">
				jiesuan_type,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=BIGINT},
			</if>
			<if test="compid != null">
				#{compid,jdbcType=BIGINT},
			</if>
			<if test="ruleName != null">
				#{ruleName,jdbcType=VARCHAR},
			</if>
			<if test="ruleTime != null">
				#{ruleTime,jdbcType=VARCHAR},
			</if>
			<if test="creator != null">
				#{creator,jdbcType=VARCHAR},
			</if>
			<if test="applyType != null">
				#{applyType,jdbcType=VARCHAR},
			</if>
			<if test="payWay != null">
				#{payWay,jdbcType=VARCHAR},
			</if>
			<if test="ruleDesc != null">
				#{ruleDesc,jdbcType=VARCHAR},
			</if>
			<if test="jiesuanType != null">
				#{jiesuanType,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.cms.model.shengchang.CompBuyRule">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update comp_buy_rule
		<set>
			<if test="compid != null">
				compId = #{compid,jdbcType=BIGINT},
			</if>
			<if test="ruleName != null">
				rule_name = #{ruleName,jdbcType=VARCHAR},
			</if>
			<if test="ruleTime != null">
				rule_time = #{ruleTime,jdbcType=VARCHAR},
			</if>
			<if test="creator != null">
				creator = #{creator,jdbcType=VARCHAR},
			</if>
			<if test="applyType != null">
				apply_type = #{applyType,jdbcType=VARCHAR},
			</if>
			<if test="payWay != null">
				pay_way = #{payWay,jdbcType=VARCHAR},
			</if>
			<if test="ruleDesc != null">
				rule_desc = #{ruleDesc,jdbcType=VARCHAR},
			</if>
			<if test="jiesuanType != null">
				jiesuan_type = #{ruleDesc,jdbcType=VARCHAR},
			</if>
		</set>
		where ID = #{id,jdbcType=BIGINT}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.cms.model.shengchang.CompBuyRule">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update comp_buy_rule
		set compId = #{compid,jdbcType=BIGINT},
		rule_name = #{ruleName,jdbcType=VARCHAR},
		rule_time = #{ruleTime,jdbcType=VARCHAR},
		creator = #{creator,jdbcType=VARCHAR},
		apply_type = #{applyType,jdbcType=VARCHAR},
		pay_way = #{payWay,jdbcType=VARCHAR},
		rule_desc = #{ruleDesc,jdbcType=VARCHAR},
		jiesuan_type = #{jiesuanType,jdbcType=VARCHAR}
		where ID = #{id,jdbcType=BIGINT}
	</update>

    <select id="getBuyRuleAreaMap" parameterType="com.cms.model.shengchang.CompBuyRule" resultType="java.util.Map">
        select GROUP_CONCAT(CONCAT(IFNULL(sheng,''),IFNULL(CONCAT('-',city),''),IFNULL(CONCAT('-',xian),''))) areaNames,
        GROUP_CONCAT(CONCAT(IFNULL(sheng_id,''),IFNULL(CONCAT('-',city_id),''),IFNULL(CONCAT('-',xian_id),''))) areaIds
        from comp_buy_rule_area where buy_id=#{id}
    </select>
</mapper>